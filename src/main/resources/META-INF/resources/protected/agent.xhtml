<?xml version='1.0' encoding='UTF-8' ?>
<!-- Cette page hÃ©rite que la structure 'layout.xhtml' -->
<ui:composition 
    xmlns="http://www.w3.org/1999/xhtml" 
    xmlns:h="http://xmlns.jcp.org/jsf/html"
    xmlns:f="http://xmlns.jcp.org/jsf/core"
    xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
    xmlns:p="http://primefaces.org/ui"
    template="/public/templates/layout.xhtml">

    <f:metadata>
        <f:importConstants type="com.github.zelmothedragon.whothere.DynamicEntity" var="DynamicEntity"/>
    </f:metadata>
    
    <ui:define name="title">
        <h1 class="center">
            <h:outputText value="#{m['agent.title']}" />
        </h1>
    </ui:define>

    <ui:define name="main">
        <h:form>
            <p:inputText 
                id="search" 
                placeholder="#{m['datatable.filter']}"
                value="#{searchController.keyword}">
                <p:ajax event="keyup" update="datatable" listener="#{searchController.search(DynamicEntity.AGENT)}" />
            </p:inputText>

            <br/>
            <br/>

            <p:dataTable 
                id="datatable" 
                value="#{searchController.entities}"
                var="e"
                emptyMessage="#{searchController.keywordEmpty ? m['datatable.too_many'] : m['datatable.empty']}"
                reflow="true">

                <p:column headerText="#{m['agent.email']}">
                    <h:outputText value="#{e.email}" />
                </p:column>

                <p:column headerText="#{m['agent.givenName']}">
                    <h:outputText value="#{e.givenName}" />
                </p:column>

                <p:column headerText="#{m['agent.familyName']}">
                    <h:outputText value="#{e.familyName}" />
                </p:column>

                <p:column headerText="#{m['agent.shortRank']}">
                    <h:outputText value="#{e.shortRank}" />
                </p:column>

                <p:column headerText="#{m['agent.rank']}">
                    <h:outputText value="#{e.rank}" />
                </p:column>

                <p:column headerText="#{m['agent.phoneNumber']}">
                    <h:outputText value="#{e.phoneNumber}" />
                </p:column>

            </p:dataTable>
        </h:form>

    </ui:define>

</ui:composition>
